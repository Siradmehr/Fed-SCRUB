model initiated
Using freshly initialized model (no checkpoint loaded)
{'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd', 'SAVING_DIR': './checkpoints/1/nf_resnet34/cifar10/2_17', 'LOADED_MODEL': NFResNet(
  (conv1): ScaledStdConv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (2): BasicBlock(
      (conv1): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (2): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (3): BasicBlock(
      (conv1): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (2): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (3): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (4): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (5): BasicBlock(
      (conv1): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): ScaledStdConv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (downsample): Sequential(
        (0): ScaledStdConv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
      )
    )
    (1): BasicBlock(
      (conv1): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
    (2): BasicBlock(
      (conv1): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (conv2): ScaledStdConv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)}
server configured
Round 1: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m Client 6 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7782d5c10>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 14984 MiB, 66066 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874690)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m training started
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5d12cc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 21570 MiB, 59480 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_1.pth
[36m(ClientAppActor pid=874812)[0m Client 6 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd94f56e750>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 1 ACC is =  0.1012
round 1 loss is =  4.22030291557312
Current best ACC is =  0.1012
Saving round 1 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 2: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caac590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 4 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846078a7ad0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f89e20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_2.pth
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76903808c260>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 2 ACC is =  0.1572
round 2 loss is =  2.4759979486465453
Current best ACC is =  0.1572
Saving round 2 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 3: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf1ba4ec0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b3fcaea0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf17f5160>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_3.pth
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b40770>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 3 ACC is =  0.2878
round 3 loss is =  1.9829643368721008
Current best ACC is =  0.2878
Saving round 3 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 4: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Client 8 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a281f5d60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5b9b770>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0bf2db0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_4.pth
[36m(ClientAppActor pid=874377)[0m Client 8 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017b350>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 4 ACC is =  0.3494
round 4 loss is =  1.7862198233604432
Current best ACC is =  0.3494
Saving round 4 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 5: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 9 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43a3b90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca5010>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m training started
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789ac4d0b3b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_5.pth
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b018eb10>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 5 ACC is =  0.3984
round 5 loss is =  1.6516526222229004
Current best ACC is =  0.3984
Saving round 5 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 6: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316efaa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0b91b80>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b488d4c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 6 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_6.pth
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bed3a0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 6 ACC is =  0.3848
round 6 loss is =  1.7093785762786866
Round 7: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 4 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874379)[0m Client 1 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f9276e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf16a85c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_7.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130b8b3b0>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 7 ACC is =  0.4456
round 7 loss is =  1.5190054059028626
Current best ACC is =  0.4456
Saving round 7 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 8: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Client 2 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a51751010>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Client 1 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b42cf0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902ca02a80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_8.pth
[36m(ClientAppActor pid=874377)[0m Client 2 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b01700e0>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 8 ACC is =  0.4764
round 8 loss is =  1.4339163661003114
Current best ACC is =  0.4764
Saving round 8 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 9: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 5 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caadd00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605cf4d40>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m training started
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4ded6d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_9.pth
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78461ebe2810>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 9 ACC is =  0.4924
round 9 loss is =  1.393823492527008
Current best ACC is =  0.4924
Saving round 9 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 10: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 2 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1caa9dc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Client 8 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb44d0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b2154710>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 10 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_10.pth
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605da6330>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 10 ACC is =  0.492
round 10 loss is =  1.406554889678955
Round 11: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f8be00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f89eb0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605c0cf80>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dbb2540>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_11.pth
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605d9b620>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 11 ACC is =  0.5096
round 11 loss is =  1.3524344205856322
Current best ACC is =  0.5096
Saving round 11 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 12: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131760980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5cfb1d0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a50202e70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_12.pth
[36m(ClientAppActor pid=874812)[0m Client 1 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b00ec860>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 12 ACC is =  0.5272
round 12 loss is =  1.3158012986183167
Current best ACC is =  0.5272
Saving round 12 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 13: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Client 5 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c9965a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7d9817b110>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a50202f30>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_13.pth
[36m(ClientAppActor pid=874377)[0m Client 5 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78461d74c680>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 13 ACC is =  0.5368
round 13 loss is =  1.2890703797340393
Current best ACC is =  0.5368
Saving round 13 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 14: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b40a3e00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 7 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b97050>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47a4da0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_14.pth
[36m(ClientAppActor pid=874386)[0m Client 2 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769038184d10>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 14 ACC is =  0.5624
round 14 loss is =  1.2422951698303222
Current best ACC is =  0.5624
Saving round 14 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 15: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7e7f0f380>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb6f60>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43ac620>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_15.pth
[36m(ClientAppActor pid=874379)[0m Client 0 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73cb92a20>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 15 ACC is =  0.5666
round 15 loss is =  1.2168194890022277
Current best ACC is =  0.5666
Saving round 15 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 16: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 0 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a28016b70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Client 9 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784604b8b260>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b017d9d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 16 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_16.pth
[36m(ClientAppActor pid=874381)[0m Client 8 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5dacda0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 16 ACC is =  0.5562
round 16 loss is =  1.2698774337768555
Round 17: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m Client 2 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0090ec0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47a4d10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_17.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131744350>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 17 ACC is =  0.575
round 17 loss is =  1.220469629764557
Current best ACC is =  0.575
Saving round 17 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 18: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0574ef0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 5 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bc53d0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47f60f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_18.pth
[36m(ClientAppActor pid=874381)[0m Client 8 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bf1070>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 18 ACC is =  0.5912
round 18 loss is =  1.167035949230194
Current best ACC is =  0.5912
Saving round 18 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 19: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7e4177290>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0b93650>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f701b50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_19.pth
[36m(ClientAppActor pid=874388)[0m Client 9 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b971d0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 19 ACC is =  0.5914
round 19 loss is =  1.1598708868026733
Current best ACC is =  0.5914
Saving round 19 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 20: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Client 3 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1c98f500>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 2 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caa08f0>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0c98a10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_20.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0daa0c0>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 20 ACC is =  0.5936
round 20 loss is =  1.167204737663269
Current best ACC is =  0.5936
Saving round 20 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 21: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0058950>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 7 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017b260>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131b9b2f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_21.pth
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bbf8f0>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 21 ACC is =  0.6202
round 21 loss is =  1.1070608615875244
Current best ACC is =  0.6202
Saving round 21 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 22: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 0 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0d87710>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Client 5 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784604b3b260>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131da7f80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 22 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_22.pth
[36m(ClientAppActor pid=874379)[0m Client 6 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c9d5af0>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 22 ACC is =  0.6166
round 22 loss is =  1.1024613618850707
Round 23: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b49fae70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566bc38d310>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_23.pth
[36m(ClientAppActor pid=874388)[0m Client 3 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b117fc80>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 23 ACC is =  0.6274
round 23 loss is =  1.0867896676063538
Current best ACC is =  0.6274
Saving round 23 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 24: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m Client 0 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b488d4c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 2 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316ef5c0>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m training started
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f8ad80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_24.pth
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bc71a0>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 24 ACC is =  0.6308
round 24 loss is =  1.0736649692058564
Current best ACC is =  0.6308
Saving round 24 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 25: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1ca476e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902ca39f10>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7feba40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 25 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_25.pth
[36m(ClientAppActor pid=874381)[0m Client 6 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a777ec90>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 25 ACC is =  0.618
round 25 loss is =  1.1092480182647706
Round 26: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf169dd60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7ebd850>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 26 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_26.pth
[36m(ClientAppActor pid=874690)[0m Client 0 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dd8bfe0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 26 ACC is =  0.6244
round 26 loss is =  1.1021386861801148
Round 27: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769023f57b00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caaea50>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cbeca70>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0c99040>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 27 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_27.pth
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a7e3b590>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 27 ACC is =  0.6248
round 27 loss is =  1.1006233096122742
Round 28: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m Client 1 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b00edd90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1ca93d70>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b013f350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 28 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_28.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605c94770>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 28 ACC is =  0.6294
round 28 loss is =  1.1146165251731872
Round 29: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Client 4 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131b5fef0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dbf7a10>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 29 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_29.pth
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846077ed370>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b09a2840>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 29 ACC is =  0.6374
round 29 loss is =  1.0635245084762572
Current best ACC is =  0.6374
Saving round 29 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 30: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m Client 2 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f8a0f0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a51751010>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_30.pth
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7e340b0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 30 ACC is =  0.6426
round 30 loss is =  1.0973134696483613
Current best ACC is =  0.6426
Saving round 30 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 31: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m Client 8 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789aba177230>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Client 2 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690ce186f30>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1caa9d60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 31 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_31.pth
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017ad50>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 31 ACC is =  0.6418
round 31 loss is =  1.0451818346977233
Round 32: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874377)[0m Client 2 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47f7aa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf17d31a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 32 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_32.pth
[36m(ClientAppActor pid=874388)[0m Client 4 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605d08770>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 32 ACC is =  0.6618
round 32 loss is =  1.0703114211559295
Current best ACC is =  0.6618
Saving round 32 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 33: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf0b97b90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605da61b0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21317e98b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 33 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_33.pth
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130b3af60>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 33 ACC is =  0.6486
round 33 loss is =  1.0331438899040222
Round 34: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Client 2 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7b40aa2d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0cecc80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874377)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1c9700e0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 34 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_34.pth
[36m(ClientAppActor pid=874379)[0m Client 5 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bbc410>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 34 ACC is =  0.6618
round 34 loss is =  1.0744703769683839
Round 35: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c979790>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5d12900>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7e4177590>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 35 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_35.pth
[36m(ClientAppActor pid=874387)[0m Client 3 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model
[36m(ClientAppActor pid=874387)[0m loading data
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605da61b0>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874387)[0m Available devices  1
[36m(ClientAppActor pid=874387)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 35 ACC is =  0.656
round 35 loss is =  1.0583289086818695
Round 36: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Client 0 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf17a0d40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca5040>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874690)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 36 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_36.pth
[36m(ClientAppActor pid=874388)[0m Client 4 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bc7e30>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 36 ACC is =  0.6594
round 36 loss is =  1.1069067478179933
Round 37: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m Client 3 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf17a1250>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f88080>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4059f70>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0ba44a0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 37 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_37.pth
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0c98740>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 37 ACC is =  0.634
round 37 loss is =  1.1238920450210572
Round 38: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 8 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cbed280>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902ca3aff0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 38 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_38.pth
[36m(ClientAppActor pid=874377)[0m Client 5 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789aba177110>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 38 ACC is =  0.6676
round 38 loss is =  1.1189408540725707
Current best ACC is =  0.6676
Saving round 38 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 39: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Client 4 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de755344e60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bc41a0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf16aa0c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 39 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_39.pth
[36m(ClientAppActor pid=874812)[0m Client 1 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf17f7740>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 39 ACC is =  0.6684
round 39 loss is =  1.0723540842533112
Current best ACC is =  0.6684
Saving round 39 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 40: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dd89610>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 6 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902ca03050>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 0] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf17a1520>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 40 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_40.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846bc604a70>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 40 ACC is =  0.6724
round 40 loss is =  1.1489929676055908
Current best ACC is =  0.6724
Saving round 40 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 41: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 3 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130b8a600>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 2 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846bc604a70>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf169d7c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 41 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_41.pth
[36m(ClientAppActor pid=874812)[0m Client 1 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7fea1e0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 41 ACC is =  0.656
round 41 loss is =  1.1186918914318085
Round 42: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m Client 6 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1caa15e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 5] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7d0818d2e0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 42 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_42.pth
[36m(ClientAppActor pid=874812)[0m Client 3 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784604b6d730>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 42 ACC is =  0.6686
round 42 loss is =  1.1590743839740754
Round 43: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caafd70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017b200>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 43 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_43.pth
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75674c370b00>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 43 ACC is =  0.6712
round 43 loss is =  1.147161841392517
Round 44: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 6 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874379)[0m Client 1 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7d081b3380>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0ced1c0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 44 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_44.pth
[36m(ClientAppActor pid=874387)[0m Client 2 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874388)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model
[36m(ClientAppActor pid=874387)[0m loading data
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605cf6c60>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 44 ACC is =  0.6704
round 44 loss is =  1.2082679748535157
Round 45: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 8 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874381)[0m Client 2 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf169eba0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4084fb0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 45 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_45.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5cfb2c0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 45 ACC is =  0.669
round 45 loss is =  1.2375846982002259
Round 46: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Client 9 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874812)[0m Client 0 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4dd16d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f927890>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 46 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_46.pth
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605d08770>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 46 ACC is =  0.6416
round 46 loss is =  1.362987208366394
Round 47: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 4 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874812)[0m Client 1 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b00ecda0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 6] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc858051250>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 8] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 47 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_47.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b01aa7b0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 47 ACC is =  0.6428
round 47 loss is =  1.3252709984779358
Round 48: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 3 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf01f15b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version
[36m(ClientAppActor pid=874812)[0m , memory.total [MiB], memory.used [MiB]
[36m(ClientAppActor pid=874812)[0m , memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43b39b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 48 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_48.pth
[36m(ClientAppActor pid=874377)[0m Client 0 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1caabda0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 48 ACC is =  0.668
round 48 loss is =  1.230759036540985
Round 49: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690e20059d0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 7] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043c49e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m [Client 1] fit, config: {'lr': 0.1, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b018fa10>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_49.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7e86630>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 49 ACC is =  0.6732
round 49 loss is =  1.2707895755767822
Current best ACC is =  0.6732
Saving round 49 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 50: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.010000000000000002
[36m(ClientAppActor pid=874377)[0m Client 0 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cbed070>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1ca93dd0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784604b3b500>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 50 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_50.pth
[36m(ClientAppActor pid=874386)[0m Client 5 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21317ebec0>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 50 ACC is =  0.6706
round 50 loss is =  1.2379511833190917
Round 51: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043b2600>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bbc110>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769023fb27e0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 51 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_51.pth
[36m(ClientAppActor pid=874379)[0m Client 0 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7fb06e0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 51 ACC is =  0.6738
round 51 loss is =  1.2302810549736023
Current best ACC is =  0.6738
Saving round 51 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_best.pth
Round 52: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c9d6480>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Client 6 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bed430>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2148040ad0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 52 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_52.pth
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1c93cef0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 52 ACC is =  0.6724
round 52 loss is =  1.2408855438232422
Round 53: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Client 0 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874385)[0m Client 8 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf1bb4d70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bedeb0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 53 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_53.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5cfa540>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 53 ACC is =  0.6734
round 53 loss is =  1.2447157740592956
Round 54: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 1 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b40a2f90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m training started
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0c99190>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 54 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_54.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b002bd40>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 54 ACC is =  0.6714
round 54 loss is =  1.2547409772872924
Round 55: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dce91c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bf2240>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 55 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_55.pth
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043c45f0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 55 ACC is =  0.6724
round 55 loss is =  1.2613373279571534
Round 56: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m Client 0 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dd89610>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f213168f770>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 56 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_56.pth
[36m(ClientAppActor pid=874388)[0m Client 3 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b00ed9d0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 56 ACC is =  0.6716
round 56 loss is =  1.2710182547569275
Round 57: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 1 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874812)[0m Client 2 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b97170>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m training started
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316aa0f0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 57 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_57.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605ba5250>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 57 ACC is =  0.6724
round 57 loss is =  1.278030478954315
Round 58: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 4 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874377)[0m Client 6 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b01fad50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789aba176d50>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43a22a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 58 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_58.pth
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78460787e630>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 58 ACC is =  0.6706
round 58 loss is =  1.2855215787887573
Round 59: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 0 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f213168fa40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47a4f50>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 59 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_59.pth
[36m(ClientAppActor pid=874690)[0m Client 5 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc85177aed0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 59 ACC is =  0.6716
round 59 loss is =  1.2939749240875245
Round 60: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m Client 0 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131794c80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc858051250>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769023f568a0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0b44a70>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 60 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_60.pth
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874388)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a2817dcd0>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 60 ACC is =  0.6722
round 60 loss is =  1.3016332864761353
Round 61: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43fb200>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bc4530>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 61 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_61.pth
[36m(ClientAppActor pid=874388)[0m Client 6 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1caa9f40>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 61 ACC is =  0.6718
round 61 loss is =  1.30999436378479
Round 62: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316a89e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0bb8b00>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874388)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 62 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_62.pth
[36m(ClientAppActor pid=874377)[0m Client 3 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca4b00>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 62 ACC is =  0.6714
round 62 loss is =  1.3171954870223999
Round 63: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690d8082690>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017b260>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 63 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_63.pth
[36m(ClientAppActor pid=874377)[0m Client 2 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78460787e630>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 63 ACC is =  0.6718
round 63 loss is =  1.3254305124282837
Round 64: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 9 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874381)[0m Client 8 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f98080>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4370f80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874690)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dba6d20>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 64 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_64.pth
[36m(ClientAppActor pid=874388)[0m Client 4 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784604be5310>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 64 ACC is =  0.6712
round 64 loss is =  1.3326567173004151
Round 65: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1caf2c60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769023f57710>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 65 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_65.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf16a91c0>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 65 ACC is =  0.6724444444444444
round 65 loss is =  1.3398323191536798
Round 66: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m Client 4 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f885d00>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789aba177350>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m training started
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73db978c0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 8] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 66 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_66.pth
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 8] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bec4d0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 66 ACC is =  0.671
round 66 loss is =  1.3488181948661804
Round 67: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m Client 5 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874386)[0m Client 8 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c9d4bf0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75674c0a7410>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1c98f4a0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f213015a6c0>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
Aggregating aggregate_fit updates from 5 clients, 5 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 67 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_67.pth
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 8] get_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043c7f80>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 67 ACC is =  0.6722
round 67 loss is =  1.3591891288757325
Round 68: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130b8b9e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b97170>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 68 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_68.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a280b4b30>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 68 ACC is =  0.6714
round 68 loss is =  1.364604079723358
Round 69: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca4d10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1c93cad0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf0b95a60>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dbf6f30>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 3] get_parameters[32m [repeated 3x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 69 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_69.pth
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 7] get_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1caab170>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 69 ACC is =  0.6706
round 69 loss is =  1.3713687896728515
Round 70: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m Client 5 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b117dbe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874388)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789aba176e40>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7fe9f10>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 70 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_70.pth
[36m(ClientAppActor pid=874381)[0m Client 6 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 7] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b40b90>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 70 ACC is =  0.6718
round 70 loss is =  1.380013072490692
Round 71: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131794c80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b4d2b0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0bf3050>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b40a1160>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 71 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_71.pth
[36m(ClientAppActor pid=874385)[0m Client 0 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bec3b0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 71 ACC is =  0.67175
round 71 loss is =  1.373723417520523
Round 72: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 8 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a8a58470>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130bb7ec0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 72 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_72.pth
[36m(ClientAppActor pid=874386)[0m Client 3 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bb2d20>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 72 ACC is =  0.6628888888888889
round 72 loss is =  1.424226959546407
Round 73: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m Client 6 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c9d42f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m training started
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130bb7890>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874386)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7da4406780>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] get_parameters[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 73 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_73.pth
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 8] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bbfa70>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 73 ACC is =  0.669
round 73 loss is =  1.4012753248214722
Round 74: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m Client 5 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0571610>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7e85f70>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc858052090>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874381)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 2 clients, 8 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 74 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_74.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4ded6d0>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874387)[0m Available devices  1
[36m(ClientAppActor pid=874387)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 74 ACC is =  0.6694
round 74 loss is =  1.4132346987724305
Round 75: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dba5370>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m training started
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f926240>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 75 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_75.pth
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b01075c0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 75 ACC is =  0.6697777777777778
round 75 loss is =  1.4107218318515353
Round 76: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m Client 8 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dbf5e20>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 7[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7e37170>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb0260>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cac4650>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 76 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_76.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7e6b620>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 76 ACC is =  0.669
round 76 loss is =  1.4238811135292053
Round 77: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a8a59fa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316b6fc0>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b40a0710>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m gpu in client
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m training started
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874387)[0m Available devices  1
[36m(ClientAppActor pid=874387)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m training started
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 2 clients, 8 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 77 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_77.pth
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043c4260>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 77 ACC is =  0.6712
round 77 loss is =  1.4326123356819154
Round 78: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316b41a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5b9be90>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 8[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7fb08c0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c9d6ab0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 78 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_78.pth
[36m(ClientAppActor pid=874812)[0m Client 2 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7d9817aed0>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 7x across cluster][0m
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 78 ACC is =  0.66525
round 78 loss is =  1.4437938034534454
Round 79: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m Client 2 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0431520>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 5] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf169dc40>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605ba6870>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 5] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 79 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_79.pth
[36m(ClientAppActor pid=874381)[0m Client 9 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 5] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769038273c20>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874387)[0m Available devices  1
[36m(ClientAppActor pid=874387)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 79 ACC is =  0.6692
round 79 loss is =  1.4447339177131653
Round 80: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf0b97f80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca4c50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf16b0d10>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 80 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_80.pth
[36m(ClientAppActor pid=874377)[0m Client 5 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb12b0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 80 ACC is =  0.6694
round 80 loss is =  1.4518311619758606
Round 81: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf16a8d10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m training started
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690380f1b20>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 81 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_81.pth
[36m(ClientAppActor pid=874381)[0m Client 8 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 1] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a77f3b90>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 81 ACC is =  0.6708
round 81 loss is =  1.4598365545272827
Round 82: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf1db3cb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 7 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b71970>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47a4ef0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 82 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_82.pth
[36m(ClientAppActor pid=874379)[0m Client 3 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690d8082d80>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 82 ACC is =  0.6677777777777778
round 82 loss is =  1.4596927563349407
Round 83: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Client 0 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dce9b50>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf16392e0>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de72ff205f0>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f213169d340>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 83 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_83.pth
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 4] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784604b89910>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 83 ACC is =  0.6698
round 83 loss is =  1.4750236034393311
Round 84: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 4 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m Client 3 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130158e00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 6[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca5790>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m training started
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf1b8cbc0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 5] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 84 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_84.pth
[36m(ClientAppActor pid=874377)[0m Client 1 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 6] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605cf62a0>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 84 ACC is =  0.6702
round 84 loss is =  1.4812401056289672
Round 85: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b40a2ea0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f213013c9b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37414 MiB, 43636 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874386)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37418 MiB, 43632 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 85 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_85.pth
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7d9817b080>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37420 MiB, 43630 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 85 ACC is =  0.6694
round 85 loss is =  1.488796091079712
Round 86: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m Client 5 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130bb7fb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37420 MiB, 43630 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0171730>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37420 MiB, 43630 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131794ad0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37420 MiB, 43630 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 86 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_86.pth
[36m(ClientAppActor pid=874381)[0m Client 3 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 2] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b71970>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37420 MiB, 43630 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 86 ACC is =  0.6694
round 86 loss is =  1.4956203818321228
Round 87: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605671520>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37420 MiB, 43630 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 2] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bf0770>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37420 MiB, 43630 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 87 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_87.pth
[36m(ClientAppActor pid=874377)[0m Client 6 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb0c20>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 87 ACC is =  0.6704
round 87 loss is =  1.5031283855438233
Round 88: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m Client 9 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf1bb7830>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316ee2a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 88 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_88.pth
[36m(ClientAppActor pid=874377)[0m Client 0 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874377)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a28267b30>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 88 ACC is =  0.6698
round 88 loss is =  1.5095834970474242
Round 89: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5cf8080>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a8bc6ba0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 8] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 89 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_89.pth
[36m(ClientAppActor pid=874812)[0m Client 3 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a8a5a600>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874387)[0m Available devices  1
[36m(ClientAppActor pid=874387)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 89 ACC is =  0.6706
round 89 loss is =  1.5174593806266785
Round 90: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690e2004980>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73db97e30>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 90 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_90.pth
[36m(ClientAppActor pid=874690)[0m Client 1 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874812)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a77f3b90>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 90 ACC is =  0.6696
round 90 loss is =  1.5245722651481628
Round 91: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m Client 1 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8e175ff50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73cb93e60>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 91 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_91.pth
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cbed310>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 91 ACC is =  0.66825
round 91 loss is =  1.5401976555585861
Round 92: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 8 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73db35730>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 7[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75674c308770>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902cba05c0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 0] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 92 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_92.pth
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 2] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769023fb1a60>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 92 ACC is =  0.6688888888888889
round 92 loss is =  1.5322033564249675
Round 93: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m Client 6 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21303f4080>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b95ac0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 9[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b117dbe0>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 7] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b405a9f0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 93 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_93.pth
[36m(ClientAppActor pid=874377)[0m Client 1 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846057586e0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 93 ACC is =  0.6717777777777778
round 93 loss is =  1.5321992635726929
Round 94: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m Client 0 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a8bc7890>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874690)[0m training started
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2148040ad0>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 3] set_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902cba0b90>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 3x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 94 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_94.pth
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 6] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b40a2db0>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m gpu in client
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 94 ACC is =  0.6686666666666666
round 94 loss is =  1.5674304167429607
Round 95: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21317e9940>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0550560>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4badb80>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21e43549e0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 95 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_95.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21301e0b90>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 95 ACC is =  0.671
round 95 loss is =  1.5604198217391967
Round 96: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 3 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca5250>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 5] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c995430>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 96 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_96.pth
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc85177a7b0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 96 ACC is =  0.6708
round 96 loss is =  1.5667589545249938
Round 97: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902cba0c80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 6] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690ce186e70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 0] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 97 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_97.pth
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5c98440>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 7x across cluster][0m
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 97 ACC is =  0.6735
round 97 loss is =  1.5680347830057144
Round 98: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874381)[0m Client 7 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874379)[0m Client 0 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690d83cbe90>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 9] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7f084bda0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 98 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_98.pth
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0daa150>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 98 ACC is =  0.6706666666666666
round 98 loss is =  1.578880164358351
Round 99: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m Client 7 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769023f576e0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 4] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605cc77d0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 6[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a777ec90>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] fit, config: {'lr': 0.010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7f088dfd0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 99 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_99.pth
[36m(ClientAppActor pid=874386)[0m Client 0 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605cf7320>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 99 ACC is =  0.6696
round 99 loss is =  1.587228524684906
Round 100: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.0010000000000000002
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Client 4 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874387)[0m Client 2 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47a4cb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690ce186d80>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874379)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 100 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_100.pth
[36m(ClientAppActor pid=874379)[0m Client 1 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caf85f0>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 100 ACC is =  0.669
round 100 loss is =  1.5877081632614136
Round 101: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b017fbf0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 2[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a8b1b110>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7e4177590>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 101 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_101.pth
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605759310>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 101 ACC is =  0.6694
round 101 loss is =  1.5881919264793396
Round 102: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43fac00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dba4380>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 102 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_102.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0575070>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 102 ACC is =  0.6696
round 102 loss is =  1.58880512714386
Round 103: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7e4177140>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43f8da0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 103 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_103.pth
[36m(ClientAppActor pid=874386)[0m Client 6 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846bc604a70>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 103 ACC is =  0.6697777777777778
round 103 loss is =  1.5893512964248657
Round 104: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 7 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a437c650>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76903814f7d0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73db96330>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 2] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 3x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 104 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_104.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 2] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789aba176f60>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 104 ACC is =  0.6696
round 104 loss is =  1.5899050116539002
Round 105: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf16a8cb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0d572f0>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5b9afc0>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 105 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_105.pth
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017b200>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 105 ACC is =  0.6704444444444444
round 105 loss is =  1.589266790284051
Round 106: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc85177b290>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 2] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690380a7770>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874379)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 106 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_106.pth
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m [Client 2] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43a3650>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m gpu in client
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874387)[0m Available devices  1
[36m(ClientAppActor pid=874387)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 106 ACC is =  0.6692
round 106 loss is =  1.5912068486213684
Round 107: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131794680>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769038184d10>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf176a990>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0105040>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 107 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_107.pth
[36m(ClientAppActor pid=874388)[0m Client 1 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874377)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690e20046e0>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 107 ACC is =  0.669
round 107 loss is =  1.5918220639228822
Round 108: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 6 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a51770530>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m training started
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21da168050>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b96b70>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7e4177470>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 9] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 6x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 108 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_108.pth
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 2] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0b45580>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 108 ACC is =  0.6698
round 108 loss is =  1.5924912095069885
Round 109: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f781a00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017bf20>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0bf34d0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7e68050>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 109 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_109.pth
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caf8e30>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 109 ACC is =  0.6695555555555556
round 109 loss is =  1.5847367842992146
Round 110: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Client 8 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874386)[0m Client 0 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131b9b5c0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dbf6a20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 110 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_110.pth
[36m(ClientAppActor pid=874377)[0m Client 5 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 8] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dda38c0>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 110 ACC is =  0.6696
round 110 loss is =  1.5939568281173706
Round 111: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m Client 8 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8e17d7dd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb1820>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b09dce00>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 2] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a517515b0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37426 MiB, 43624 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 5] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 111 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_111.pth
[36m(ClientAppActor pid=874690)[0m Client 5 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0575070>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 111 ACC is =  0.6696
round 111 loss is =  1.5946130752563477
Round 112: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 0 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874385)[0m Client 9 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130bb6990>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dd8a180>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 112 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_112.pth
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a796e870>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 112 ACC is =  0.6692
round 112 loss is =  1.595217192173004
Round 113: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b42f2d80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43ad490>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 113 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_113.pth
[36m(ClientAppActor pid=874386)[0m Client 5 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73cb93740>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 113 ACC is =  0.6717777777777778
round 113 loss is =  1.5890307823816936
Round 114: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m Client 4 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a8a58f20>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 6[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7e6b620>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043b3860>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47a4ad0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 114 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_114.pth
[36m(ClientAppActor pid=874377)[0m Client 4 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cbed010>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 114 ACC is =  0.6692
round 114 loss is =  1.5965120673179627
Round 115: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316ee540>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76903808c260>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 115 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_115.pth
[36m(ClientAppActor pid=874388)[0m Client 7 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0bf2030>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 115 ACC is =  0.6694
round 115 loss is =  1.597118091583252
Round 116: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874381)[0m Client 2 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b41d60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb04a0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b97ef0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21da168dd0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 116 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_116.pth
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5cf84d0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 116 ACC is =  0.6696
round 116 loss is =  1.5977332711219787
Round 117: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m client loading model
[36m(ClientAppActor pid=874387)[0m loading data
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b488cb00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73cb77230>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874690)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 117 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_117.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769023fc1760>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 117 ACC is =  0.6696
round 117 loss is =  1.5983440160751343
Round 118: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874381)[0m Client 2 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874387)[0m Client 1 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf3f87080>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789aba176780>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902cab7d40>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 118 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_118.pth
[36m(ClientAppActor pid=874379)[0m Client 8 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 1] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690381fd040>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 118 ACC is =  0.669
round 118 loss is =  1.5989378690719604
Round 119: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m Client 2 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0090c20>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f7fb350>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 4] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 119 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_119.pth
[36m(ClientAppActor pid=874381)[0m Client 4 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5c9b2f0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 119 ACC is =  0.6694
round 119 loss is =  1.5996025681495667
Round 120: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 6 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902ca029c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b2154710>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b013c1d0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd94f56f4d0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 120 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_120.pth
[36m(ClientAppActor pid=874379)[0m Client 3 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874812)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b71910>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 120 ACC is =  0.66475
round 120 loss is =  1.6063105911016464
Round 121: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7da00b2d50>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 7] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc85cc05b80>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902ca02e10>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43ac350>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 5x across cluster][0m
Aggregating aggregate_fit updates from 7 clients, 3 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 121 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_121.pth
[36m(ClientAppActor pid=874386)[0m Client 0 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 3] get_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b4daf0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 121 ACC is =  0.6698
round 121 loss is =  1.6006916046142579
Round 122: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Client 7 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dba5c10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76903801f110>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 122 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_122.pth
[36m(ClientAppActor pid=874379)[0m Client 1 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c1cd250>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 122 ACC is =  0.6698
round 122 loss is =  1.6014315247535706
Round 123: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47d0710>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf0b95b20>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 123 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_123.pth
[36m(ClientAppActor pid=874812)[0m Client 1 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b2154710>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 7x across cluster][0m
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 123 ACC is =  0.672
round 123 loss is =  1.5877856016159058
Round 124: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 9 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2130bb5910>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m training started
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131cc9ee0>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 7] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874379)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902cba0800>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 5] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 9] get_parameters[32m [repeated 6x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 124 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_124.pth
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 5] get_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043c7d10>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 124 ACC is =  0.6698
round 124 loss is =  1.6028515338897704
Round 125: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73db97aa0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f990d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 125 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_125.pth
[36m(ClientAppActor pid=874379)[0m Client 4 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caa0e00>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 125 ACC is =  0.6694
round 125 loss is =  1.6035083055496215
Round 126: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf0b48e60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017b140>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf01f11f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 126 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_126.pth
[36m(ClientAppActor pid=874812)[0m Client 0 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd94f56f470>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 126 ACC is =  0.6624444444444444
round 126 loss is =  1.6398163768980238
Round 127: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 4 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73cbd5ac0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 1] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dba5730>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 127 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_127.pth
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78461e1cf4d0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 127 ACC is =  0.6694
round 127 loss is =  1.6048407673835754
Round 128: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cba0fb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caf85f0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4370290>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca4fb0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 128 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_128.pth
[36m(ClientAppActor pid=874377)[0m Client 3 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b4deb0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 128 ACC is =  0.669
round 128 loss is =  1.6054192185401917
Round 129: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 4 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a50203bf0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 8[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21316b5c70>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 9] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 129 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_129.pth
[36m(ClientAppActor pid=874388)[0m Client 3 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874388)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0dec2c0>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 129 ACC is =  0.6692
round 129 loss is =  1.6060624718666077
Round 130: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 9 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b2154380>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874385)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dba44a0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 8] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 130 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_130.pth
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043c4710>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 130 ACC is =  0.6692
round 130 loss is =  1.6067344069480896
Round 131: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73cb77230>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73cb77230>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874690)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 131 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_131.pth
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model
[36m(ClientAppActor pid=874387)[0m loading data
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b40a3020>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 6x across cluster][0m
Aggregating aggregate_evaluate updates from 7 clients, 3 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 131 ACC is =  0.672
round 131 loss is =  1.5784623282296317
Round 132: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m Client 7 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dba4590>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605c949b0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caad040>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43acf20>, len val=500, len test=500[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 132 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_132.pth
[36m(ClientAppActor pid=874812)[0m Client 0 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb5610>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b476c110>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 132 ACC is =  0.6692
round 132 loss is =  1.6080714583396911
Round 133: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605ba4cb0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf17a12e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 133 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_133.pth
[36m(ClientAppActor pid=874690)[0m Client 2 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dd12a50>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874387)[0m Available devices  1
[36m(ClientAppActor pid=874387)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 133 ACC is =  0.669
round 133 loss is =  1.6087553381919861
Round 134: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Client 0 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874385)[0m Client 3 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21da168050>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca5400>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 6] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690d97cd940>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 134 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_134.pth
[36m(ClientAppActor pid=874812)[0m Client 4 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 8] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bbefc0>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 134 ACC is =  0.669
round 134 loss is =  1.6092326521873475
Round 135: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Client 3 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dbf7d10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf1bb7830>, len val=500, len test=500[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 4x across cluster][0m
Aggregating aggregate_fit updates from 5 clients, 5 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 135 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_135.pth
[36m(ClientAppActor pid=874690)[0m Client 6 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 8] get_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model
[36m(ClientAppActor pid=874690)[0m loading data
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf0b95850>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874377)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 135 ACC is =  0.6702
round 135 loss is =  1.6103315711021424
Round 136: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x756756aff9b0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846077ed370>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 9[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902cab6c90>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf013c650>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874385)[0m [Client 5] get_parameters
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 136 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_136.pth
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 7] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75674c0d82f0>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 136 ACC is =  0.6694
round 136 loss is =  1.6109583497047424
Round 137: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 8 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c9963c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4059b20>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874690)[0m [Client 3] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dd89610>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 3] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 6] get_parameters[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 137 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_137.pth
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 3] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846bc604a70>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 137 ACC is =  0.6696
round 137 loss is =  1.6115686297416687
Round 138: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m Client 7 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21317e9c10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cb35550>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 138 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_138.pth
[36m(ClientAppActor pid=874378)[0m Client 2 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf163b5c0>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 8x across cluster][0m
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 138 ACC is =  0.6702222222222223
round 138 loss is =  1.610715428988139
Round 139: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874381)[0m Client 0 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bc4d40>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c9d7b90>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bbff80>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca4da0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 2] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 139 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_139.pth
[36m(ClientAppActor pid=874377)[0m Client 2 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1ca920c0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 139 ACC is =  0.6653333333333333
round 139 loss is =  1.626788232061598
Round 140: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874812)[0m client loading model
[36m(ClientAppActor pid=874812)[0m loading data
[36m(ClientAppActor pid=874812)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47a4a10>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f781a00>, len val=500, len test=500[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 9] set_parameters[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 9] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 2x across cluster][0m
Aggregating aggregate_fit updates from 3 clients, 7 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 140 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_140.pth
[36m(ClientAppActor pid=874379)[0m Client 2 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 9] get_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd94f56ff80>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 140 ACC is =  0.669
round 140 loss is =  1.614225935935974
Round 141: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874381)[0m Client 5 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b43c50>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b4dd00>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cba0170>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 7] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m training started
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75674c370b00>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 141 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_141.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m [Client 6] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b8f4a0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 141 ACC is =  0.6692
round 141 loss is =  1.6147043108940125
Round 142: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd94f56ffe0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f98680>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 1] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 142 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_142.pth
[36m(ClientAppActor pid=874385)[0m Client 1 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8c83c6930>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 142 ACC is =  0.6696
round 142 loss is =  1.6152333736419677
Round 143: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 7 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca48c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 6] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7d9817af60>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a5a439bb0>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m gpu in client
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m training started
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2
Aggregating aggregate_fit updates from 2 clients, 8 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 143 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_143.pth
[36m(ClientAppActor pid=874388)[0m Client 3 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b018d820>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 143 ACC is =  0.6692
round 143 loss is =  1.6154130578041077
Round 144: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73db372c0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m training started
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x769023fb1af0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 144 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_144.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874379)[0m [Client 4] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7fbd340>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 144 ACC is =  0.6688
round 144 loss is =  1.6158629298210143
Round 145: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b405a9f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 5x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 2] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dce9580>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 2] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 145 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_145.pth
[36m(ClientAppActor pid=874385)[0m Client 0 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7fbe390>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 145 ACC is =  0.6698
round 145 loss is =  1.6167242646217346
Round 146: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Client 4 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43a2930>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4058cb0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 146 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_146.pth
[36m(ClientAppActor pid=874377)[0m Client 1 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 0] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b013f410>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 146 ACC is =  0.66525
round 146 loss is =  1.6315220445394516
Round 147: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m Client 7 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m Client 0 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a437f4d0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75674c0a7380>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a437e9c0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1c145c70>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 8] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 147 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_147.pth
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m [Client 8] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc85177afc0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 147 ACC is =  0.669
round 147 loss is =  1.6179452538490295
Round 148: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m Client 5 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874379)[0m Client 2 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21e4355a60>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 2[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 1] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf1bb7830>, len val=500, len test=500
[36m(ClientAppActor pid=874812)[0m gpu in client
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874812)[0m Available devices  1
[36m(ClientAppActor pid=874812)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874812)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m training started
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179c03b73b0>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m gpu in client
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874387)[0m Available devices  1
[36m(ClientAppActor pid=874387)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 4] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1caa0200>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 4] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 8] get_parameters[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 148 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_148.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5c601d0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 148 ACC is =  0.669
round 148 loss is =  1.6185487747192382
Round 149: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 1 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874690)[0m Client 6 / 10
[36m(ClientAppActor pid=874690)[0m client calling
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0d572f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 2 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 0] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690382ed580>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] fit, config: {'lr': 0.0010000000000000002, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 149 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_149.pth
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1c157c50>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 149 ACC is =  0.6696
round 149 loss is =  1.6191393852233886
Round 150: Phase = LEARN
10 clients selected for training
UPDATING LEARNING RATE TO 0.00010000000000000003
[36m(ClientAppActor pid=874388)[0m Client 0 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b49fae70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m Client 1 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784604b3b770>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0c99010>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cbed5e0>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 150 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_150.pth
[36m(ClientAppActor pid=874379)[0m Client 5 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 5] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131794e60>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 150 ACC is =  0.6696
round 150 loss is =  1.6192172408103942
Round 151: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4b40f80>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789abbf701d0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc85177b080>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c198e90>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 151 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_151.pth
[36m(ClientAppActor pid=874378)[0m Client 0 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 4] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874379)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78460787e630>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 151 ACC is =  0.6696
round 151 loss is =  1.619285476207733
Round 152: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 8 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f2131caf5f0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43fb4d0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 152 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_152.pth
[36m(ClientAppActor pid=874387)[0m Client 1 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model
[36m(ClientAppActor pid=874387)[0m loading data
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874387)[0m partition loaded
[36m(ClientAppActor pid=874387)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a50202c90>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m gpu in client
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 152 ACC is =  0.6692
round 152 loss is =  1.6193487167358398
Round 153: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690381fd040>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bbc320>, len val=500, len test=500[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874377)[0m training started
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37432 MiB, 43618 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 7] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf1cfce00>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 153 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_153.pth
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 3 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605beeb70>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37438 MiB, 43612 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 153 ACC is =  0.6696
round 153 loss is =  1.6193775892257691
Round 154: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874812)[0m Client 5 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874377)[0m Client 3 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4240dd0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37438 MiB, 43612 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0570380>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37438 MiB, 43612 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874379)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902c995c70>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37438 MiB, 43612 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 154 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_154.pth
[36m(ClientAppActor pid=874378)[0m Client 3 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 7] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605da7650>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37438 MiB, 43612 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 154 ACC is =  0.6696
round 154 loss is =  1.6194703459739686
Round 155: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a5db4d820>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Client 1 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37438 MiB, 43612 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784604b8a210>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37438 MiB, 43612 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 155 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_155.pth
[36m(ClientAppActor pid=874378)[0m Client 1 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605758470>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 155 ACC is =  0.6694
round 155 loss is =  1.6195161819458008
Round 156: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Client 1 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874385)[0m Client 0 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd94f56e7e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 7[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7b7cf171a210>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 156 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_156.pth
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874812)[0m [Client 6] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21317e99d0>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874386)[0m Available devices  1
[36m(ClientAppActor pid=874386)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 156 ACC is =  0.6692
round 156 loss is =  1.619609773159027
Round 157: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874381)[0m Client 3 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b00c3a40>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m Client 8 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a4bae420>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 8[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017ad50>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874381)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874381)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 3] get_parameters
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f7fba10>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 157 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_157.pth
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21da168dd0>, len val=500, len test=500
[36m(ClientAppActor pid=874386)[0m gpu in client
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 157 ACC is =  0.6697777777777778
round 157 loss is =  1.6123789681328669
Round 158: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 4 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b013dee0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0ced610>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a893c7a0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 158 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_158.pth
[36m(ClientAppActor pid=874386)[0m Client 0 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 1] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902caa3f50>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 158 ACC is =  0.669
round 158 loss is =  1.6197702646255494
Round 159: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m Client 2 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dda0a70>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846043c7b90>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5cfa540>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090
[36m(ClientAppActor pid=874388)[0m , 535.230.02, 24564 MiB
[36m(ClientAppActor pid=874388)[0m , 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 6] get_parameters
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a453de50>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 159 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_159.pth
[36m(ClientAppActor pid=874377)[0m Client 3 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874385)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874379)[0m partition loaded
[36m(ClientAppActor pid=874379)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605c0e360>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 159 ACC is =  0.6702222222222223
round 159 loss is =  1.6183091931872897
Round 160: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874386)[0m Client 0 / 10
[36m(ClientAppActor pid=874386)[0m client calling
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f213169ca70>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 7
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846bc604a70>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 7] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0c10fe0>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 7] get_parameters
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b017e450>, len val=500, len test=500[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 160 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_160.pth
[36m(ClientAppActor pid=874385)[0m Client 2 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 2
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874381)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd9582007d0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 2] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 160 ACC is =  0.6694
round 160 loss is =  1.6199455499649047
Round 161: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 7 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 2 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x76902cba12e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m [Client 8] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b017e4e0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 8] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1ca93800>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 161 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_161.pth
[36m(ClientAppActor pid=874381)[0m Client 0 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 8] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 7 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b96e70>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 161 ACC is =  0.6696
round 161 loss is =  1.6199576020240785
Round 162: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b47a4d10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m Client 0 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m training started
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179a893f410>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 162 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_162.pth
[36m(ClientAppActor pid=874379)[0m Client 5 / 10
[36m(ClientAppActor pid=874379)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605bbca10>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 162 ACC is =  0.672
round 162 loss is =  1.6142166190677218
Round 163: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874385)[0m Client 0 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7f8bb30>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 7] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 7[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b00c02c0>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 0] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dca5010>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 7] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 163 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_163.pth
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 6] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7690381fd040>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 6] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 163 ACC is =  0.6692
round 163 loss is =  1.6201096773147583
Round 164: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Client 4 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874387)[0m Client 0 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874387)[0m client loading model
[36m(ClientAppActor pid=874387)[0m loading data
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x717a5356ac90>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 7 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 3[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a57fa840>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 2] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 2] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 164 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_164.pth
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 3] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m 
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0ba4e30>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874387)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874381)[0m before loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 164 ACC is =  0.6692
round 164 loss is =  1.620176112651825
Round 165: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1c98fbc0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 3 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 3[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 3] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 1] get_parameters
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7e340b0>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] set_parameters[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 4x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 3] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 165 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_165.pth
[36m(ClientAppActor pid=874377)[0m Client 3 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874386)[0m [Client 9] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874377)[0m partition loaded
[36m(ClientAppActor pid=874377)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1ca93fb0>, len val=500, len test=500
[36m(ClientAppActor pid=874377)[0m gpu in client
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874377)[0m Available devices  1
[36m(ClientAppActor pid=874377)[0m Current cuda device  0
[36m(ClientAppActor pid=874377)[0m [Client 3] set_parameters
[36m(ClientAppActor pid=874377)[0m before loading model statdict
[36m(ClientAppActor pid=874377)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
Aggregating aggregate_evaluate updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 165 ACC is =  0.6697777777777778
round 165 loss is =  1.6128891309102376
Round 166: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m Client 0 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43a28d0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 4] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Client 6 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 5] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b01a9520>, len val=500, len test=500[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 7] set_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 5] get_parameters
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 3x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m training started[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m number of epochs in this 2[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x789a1cbc8290>, len val=500, len test=500[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m gpu in client[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Active CUDA Device: GPU 0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Available devices  1[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m Current cuda device  0[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m [Client 8] set_parameters[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m before loading model statdict[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m after loading model statdict[32m [repeated 3x across cluster][0m
Aggregating aggregate_fit updates from 9 clients, 1 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 166 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_166.pth
[36m(ClientAppActor pid=874387)[0m Client 1 / 10
[36m(ClientAppActor pid=874387)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 1] get_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model
[36m(ClientAppActor pid=874387)[0m loading data
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874690)[0m Client 5 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b43fa720>, len val=500, len test=500
[36m(ClientAppActor pid=874387)[0m gpu in client
[36m(ClientAppActor pid=874387)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874387)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874387)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 166 ACC is =  0.6692
round 166 loss is =  1.6202964186668396
Round 167: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m client loading model
[36m(ClientAppActor pid=874377)[0m loading data
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de7782d5c10>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 4] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874387)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 9[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0d16ff0>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874388)[0m Available devices  1
[36m(ClientAppActor pid=874388)[0m Current cuda device  0
[36m(ClientAppActor pid=874388)[0m [Client 4] set_parameters
[36m(ClientAppActor pid=874388)[0m before loading model statdict
[36m(ClientAppActor pid=874388)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0a9ab40>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 4] get_parameters
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73db97fb0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 8x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 167 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_167.pth
[36m(ClientAppActor pid=874378)[0m Client 5 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874690)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874386)[0m partition loaded
[36m(ClientAppActor pid=874386)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b017b110>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 167 ACC is =  0.6692
round 167 loss is =  1.6203903794288634
Round 168: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 0 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874378)[0m Client 8 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0daa090>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 9] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 5 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded
[36m(ClientAppActor pid=874388)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874388)[0m training started
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7f21e01f4110>, len val=500, len test=500[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m gpu in client[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __CUDNN VERSION: 90100[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m __Number CUDA Devices: 1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Active CUDA Device: GPU 0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Available devices  1[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874386)[0m Current cuda device  0[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m [Client 5] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874386)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 0] get_parameters
[36m(ClientAppActor pid=874386)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874386)[0m before loading model statdict
[36m(ClientAppActor pid=874386)[0m after loading model statdict
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 168 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_168.pth
[36m(ClientAppActor pid=874385)[0m Client 1 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 5] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8a7ebca40>, len val=500, len test=500
[36m(ClientAppActor pid=874385)[0m gpu in client
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874385)[0m Available devices  1
[36m(ClientAppActor pid=874385)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m [Client 1] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874690)[0m Client 6 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 168 ACC is =  0.6692
round 168 loss is =  1.62043354511261
Round 169: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x78461e1af0e0>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m [Client 4] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m Client 2 / 10[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 10x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 9
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874385)[0m partition loaded
[36m(ClientAppActor pid=874385)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x784605b94f50>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 4[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc7a5bb3050>, len val=500, len test=500
[36m(ClientAppActor pid=874381)[0m gpu in client
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874381)[0m Available devices  1
[36m(ClientAppActor pid=874381)[0m Current cuda device  0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874385)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874385)[0m before loading model statdict
[36m(ClientAppActor pid=874385)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m training started
[36m(ClientAppActor pid=874385)[0m number of epochs in this 2
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874387)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b40591c0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 169 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_169.pth
[36m(ClientAppActor pid=874388)[0m Client 5 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874387)[0m [Client 2] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m client loading model
[36m(ClientAppActor pid=874388)[0m loading data
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 5
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874378)[0m Client 4 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 4[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73dce9b50>, len val=500, len test=500
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m gpu in client
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m partition loaded[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m len partition= 5000[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 7 clients, 3 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
round 169 ACC is =  0.6665714285714286
round 169 loss is =  1.6505306448255266
Round 170: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 9 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 0
[36m(ClientAppActor pid=874381)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cc858167590>, len val=500, len test=500[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m gpu in client[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __CUDNN VERSION: 90100[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m __Number CUDA Devices: 1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 6] set_parameters[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874381)[0m after loading model statdict[32m [repeated 6x across cluster][0m
[36m(ClientAppActor pid=874378)[0m partition loaded
[36m(ClientAppActor pid=874378)[0m len partition= 5000
[36m(ClientAppActor pid=874387)[0m Client 8 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m partition loaded
[36m(ClientAppActor pid=874381)[0m len partition= 5000
[36m(ClientAppActor pid=874388)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m loading data completed, start partitioning for 5[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7846b2157ad0>, len val=500, len test=500
[36m(ClientAppActor pid=874378)[0m gpu in client
[36m(ClientAppActor pid=874378)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874378)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874378)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874378)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874378)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874378)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874378)[0m Available devices  1
[36m(ClientAppActor pid=874378)[0m Current cuda device  0
[36m(ClientAppActor pid=874378)[0m [Client 9] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874378)[0m [Client 9] set_parameters
[36m(ClientAppActor pid=874378)[0m before loading model statdict
[36m(ClientAppActor pid=874378)[0m after loading model statdict
[36m(ClientAppActor pid=874378)[0m training started
[36m(ClientAppActor pid=874378)[0m number of epochs in this 2
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m [Client 9] get_parameters
[36m(ClientAppActor pid=874377)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7179b4059370>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 0] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m [Client 0] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m training started[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874812)[0m number of epochs in this 2[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 10 clients, 0 failures
[]
Saving round 170 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_170.pth
[36m(ClientAppActor pid=874812)[0m Client 3 / 10
[36m(ClientAppActor pid=874812)[0m client calling
[36m(ClientAppActor pid=874381)[0m [Client 0] get_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874379)[0m client loading model
[36m(ClientAppActor pid=874379)[0m loading data
[36m(ClientAppActor pid=874379)[0m loading data completed, start partitioning for 8
[36m(ClientAppActor pid=874812)[0m partition loaded
[36m(ClientAppActor pid=874812)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 1 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x75674c370b00>, len val=500, len test=500
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m gpu in client
[36m(ClientAppActor pid=874379)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874379)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874379)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874379)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874379)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874379)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874379)[0m Available devices  1
[36m(ClientAppActor pid=874379)[0m Current cuda device  0
[36m(ClientAppActor pid=874379)[0m [Client 8] set_parameters
[36m(ClientAppActor pid=874379)[0m before loading model statdict
[36m(ClientAppActor pid=874379)[0m after loading model statdict
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 170 ACC is =  0.6692
round 170 loss is =  1.620582604408264
Round 171: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874690)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Client 6 / 10
[36m(ClientAppActor pid=874388)[0m client calling
[36m(ClientAppActor pid=874381)[0m Client 0 / 10
[36m(ClientAppActor pid=874381)[0m client calling
[36m(ClientAppActor pid=874386)[0m client loading model
[36m(ClientAppActor pid=874386)[0m loading data
[36m(ClientAppActor pid=874386)[0m loading data completed, start partitioning for 4
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73f7fb350>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874381)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m [Client 6] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874388)[0m partition loaded[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m len partition= 5000[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m Client 9 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874812)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874377)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m loading data completed, start partitioning for 2[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m [Client 8] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}
[36m(ClientAppActor pid=874379)[0m training started
[36m(ClientAppActor pid=874379)[0m number of epochs in this 2
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874379)[0m [Client 8] get_parameters
[36m(ClientAppActor pid=874388)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7566b0d579b0>, len val=500, len test=500[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m gpu in client[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __CUDNN VERSION: 90100[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m __Number CUDA Devices: 1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Active CUDA Device: GPU 0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Available devices  1[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m Current cuda device  0[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 6] set_parameters[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m before loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m after loading model statdict[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874388)[0m [Client 6] fit, config: {'lr': 0.00010000000000000003, 'Phase': 'LEARN', 'local_epochs': 2}[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m training started[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874388)[0m number of epochs in this 2[32m [repeated 7x across cluster][0m
Aggregating aggregate_fit updates from 8 clients, 2 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
Saving round 171 aggregated_parameters...
Model saved to ./checkpoints/1/nf_resnet34/cifar10/2_17/models_chkpts/model_round_171.pth
[36m(ClientAppActor pid=874385)[0m Client 1 / 10
[36m(ClientAppActor pid=874385)[0m client calling
[36m(ClientAppActor pid=874388)[0m [Client 6] get_parameters[32m [repeated 7x across cluster][0m
[36m(ClientAppActor pid=874385)[0m client loading model
[36m(ClientAppActor pid=874385)[0m loading data
[36m(ClientAppActor pid=874385)[0m loading data completed, start partitioning for 1
[36m(ClientAppActor pid=874690)[0m partition loaded
[36m(ClientAppActor pid=874690)[0m len partition= 5000
[36m(ClientAppActor pid=874386)[0m Client 9 / 10[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874386)[0m client calling[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874690)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7de73ddb4a40>, len val=500, len test=500
[36m(ClientAppActor pid=874690)[0m gpu in client
[36m(ClientAppActor pid=874690)[0m __CUDNN VERSION: 90100
[36m(ClientAppActor pid=874690)[0m __Number CUDA Devices: 1
[36m(ClientAppActor pid=874690)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}
[36m(ClientAppActor pid=874690)[0m cuda:0
[36m(ClientAppActor pid=874690)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB]
[36m(ClientAppActor pid=874690)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB
[36m(ClientAppActor pid=874690)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB
[36m(ClientAppActor pid=874690)[0m Active CUDA Device: GPU 0
[36m(ClientAppActor pid=874690)[0m Available devices  1
[36m(ClientAppActor pid=874690)[0m Current cuda device  0
[36m(ClientAppActor pid=874690)[0m [Client 5] set_parameters
[36m(ClientAppActor pid=874690)[0m before loading model statdict
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 6[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874690)[0m after loading model statdict
[36m(ClientAppActor pid=874386)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874386)[0m cuda:0
[36m(ClientAppActor pid=874378)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874378)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m partition loaded[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m len partition= 5000[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874377)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874377)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874379)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874388)[0m cuda:0
[36m(ClientAppActor pid=874381)[0m cuda:0
[36m(ClientAppActor pid=874812)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m forget=0, retrain=4000
[36m(ClientAppActor pid=874387)[0m cuda:0
[36m(ClientAppActor pid=874385)[0m cuda:0
Aggregating aggregate_evaluate updates from 10 clients, 0 failures
[]
round 171 ACC is =  0.6692
round 171 loss is =  1.6206278681755066
Round 172: Phase = LEARN
10 clients selected for training
[36m(ClientAppActor pid=874378)[0m Client 6 / 10
[36m(ClientAppActor pid=874378)[0m client calling
[36m(ClientAppActor pid=874377)[0m Client 7 / 10
[36m(ClientAppActor pid=874377)[0m client calling
[36m(ClientAppActor pid=874385)[0m len retrain=4000, len forgetset=<torch.utils.data.dataset.Subset object at 0x7cd8b0197b00>, len val=500, len test=500[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m gpu in client[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __CUDNN VERSION: 90100[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m __Number CUDA Devices: 1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m {'NAME': 'fed_fscrub', 'RESUME': 'None', 'DATASET': 'cifar10', 'DATAROOT': 'data/cifar10', 'DISABLE_BN': 'true', 'MODEL': 'nf_resnet34', 'CONFUSE_MODE': 'false', 'SEED': '17', 'CONFIG_ID': '1', 'CONFIG_NUMBER': '2', 'FORGET_CLASS': {}, 'NUM_CLASSES': '10', 'LOCAL_EPOCHS': '2', 'NUM_ROUNDS': '200', 'MIN_CLIENTS': '5', 'NUM_SUPERNODES': '10', 'CLIENT_RESOURCES_NUM_CPUS': '2', 'CLIENT_RESOURCES_NUM_GPUS': '0.05', 'STARTING_PHASE': 'LEARN', 'SPLIT': 'train', 'AUGMENT': 'false', 'QUIET': 'false', 'BATCH_SIZE': '128', 'RETAIN_BS': '64', 'FORGET_BS': '16', 'MOMENTUM': '0.9', 'EPOCHS': '31', 'L1': 'false', 'NO_CUDA': 'false', 'STEP_SIZE': '-1', 'UNFREEZE_START': 'None', 'WEIGHT_DECAY': '0.0005', 'LR_DECAY_EPOCHS': '10,50,100', 'LR': '0.1', 'LR_DECAY_RATE': '0.1', 'PRINT_FREQ': '50', 'OPTIM': 'adam', 'MSTEPS': '2', 'CLIP': '0.2', 'SSTART': '10', 'SGDA_EPOCHS': '3', 'SGDA_WEIGHT_DECAY': '0.1', 'SGDA_MOMENTUM': '0.9', 'DEVICE': 'cuda:0', 'LSSFN': 'ce', 'LOSSCLS': 'JS', 'LOSSCLS_ARGS': '0', 'LOSSKD': 'JS', 'LOSSKD_ARGS': '0', 'LOSSDIV': 'JS', 'LOSSDIV_ARGS': '0', 'GAMMA': '1.0', 'ALPHA': '0.5', 'BETA': '0.0', 'SMOOTHING': '0.5', 'KD_T': '2.0', 'DISTILL': 'kd'}[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m index, name, driver_version, memory.total [MiB], memory.used [MiB], memory.free [MiB][32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 0, NVIDIA GeForce RTX 4090, 535.230.02, 24564 MiB, 3 MiB, 24214 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m 1, NVIDIA A100-SXM4-80GB, 535.230.02, 81920 MiB, 37444 MiB, 43606 MiB[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Active CUDA Device: GPU 0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Available devices  1[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m Current cuda device  0[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m [Client 1] set_parameters[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874385)[0m before loading model statdict[32m [repeated 9x across cluster][0m
[36m(ClientAppActor pid=874378)[0m client loading model
[36m(ClientAppActor pid=874378)[0m loading data
[36m(ClientAppActor pid=874378)[0m loading data completed, start partitioning for 6
[36m(ClientAppActor pid=874381)[0m client loading model
[36m(ClientAppActor pid=874381)[0m loading data
[36m(ClientAppActor pid=874381)[0m loading data completed, start partitioning for 3
[36m(ClientAppActor pid=874385)[0m after loading model statdict[32m [repeated 9x across cluster][0m
Aggregating aggregate_fit updates from 0 clients, 10 failures
[ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874386, ip=172.30.1.99, actor_id=06704fc7a977135ebadb5de601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f21e4513c20>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874387, ip=172.30.1.99, actor_id=f529802735a833f9349a587701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x717a5a439970>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874812, ip=172.30.1.99, actor_id=c182c68c4d6680f9bb5230eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b7da44047a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874379, ip=172.30.1.99, actor_id=e991412d5320ca1dbfa4edc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7690e20068a0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874377, ip=172.30.1.99, actor_id=f2f9e361521d60af4d51515301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x789ace039cd0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874388, ip=172.30.1.99, actor_id=7a6c8db26676f44903f9c4af01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x756754145fa0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874381, ip=172.30.1.99, actor_id=c136dc9e338fc7ec23303add01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cc85cc06840>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874690, ip=172.30.1.99, actor_id=8fcd683443ef459aef25f92c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7de7f088daf0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874378, ip=172.30.1.99, actor_id=9a5c3dd25964ddfcb621232f01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7846bd581340>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.'), ValueError('Message contains an Error (reason: <class \'ray.exceptions.RayTaskError(ClientAppException)\'>:<\'\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/requests/models.py", line 1024, in raise_for_status\n    raise HTTPError(http_error_msg, response=self)\nrequests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 58, in run\n    out_message = app(message=message, context=context)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 143, in __call__\n    return self._call(message, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/client_app.py", line 124, in ffn\n    out_message = handle_legacy_message_from_msgtype(\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype\n    client = client_fn(context)\n             ^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/client.py", line 245, in client_fn\n    retrainloader, forgetloader, valloader, testloader = load_datasets_with_forgetting(partition_id, num_partitions\\\n                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/Fed-SCRUB/src/dataloaders/client_dataloader.py", line 57, in load_datasets_with_forgetting\n    partition = fds.load_partition(partition_id)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 177, in load_partition\n    self._prepare_dataset()\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr_datasets/federated_dataset.py", line 314, in _prepare_dataset\n    self._dataset = datasets.load_dataset(\n                    ^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 2132, in load_dataset\n    builder_instance = load_dataset_builder(\n                       ^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/load.py", line 1890, in load_dataset_builder\n    builder_instance: DatasetBuilder = builder_cls(\n                                       ^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 342, in __init__\n    self.config, self.config_id = self._create_builder_config(\n                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 597, in _create_builder_config\n    builder_config._resolve_data_files(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/builder.py", line 206, in _resolve_data_files\n    self.data_files = self.data_files.resolve(base_path, download_config)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 818, in resolve\n    out[key] = data_files_patterns_list.resolve(base_path, download_config)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 771, in resolve\n    resolve_pattern(\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/datasets/data_files.py", line 388, in resolve_pattern\n    for filepath, info in fs.glob(pattern, detail=True, **glob_kwargs).items()\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 521, in glob\n    return super().glob(path, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 611, in glob\n    allpaths = self.find(root, maxdepth=depth, withdirs=True, detail=True, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 556, in find\n    return super().find(\n           ^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/fsspec/spec.py", line 502, in find\n    out[path] = self.info(path)\n                ^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_file_system.py", line 719, in info\n    paths_info = self._api.get_paths_info(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn\n    return fn(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/hf_api.py", line 3289, in get_paths_info\n    hf_raise_for_status(response)\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 481, in hf_raise_for_status\n    raise _format(HfHubHTTPError, str(e), response) from e\nhuggingface_hub.errors.HfHubHTTPError: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\n\nThe above exception was the direct cause of the following exception:\n\n\x1b[36mray::ClientAppActor.run()\x1b[39m (pid=874385, ip=172.30.1.99, actor_id=b54c28025de1165a7542544201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7cd961b55af0>)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/Projects/fedun/fed/lib/python3.12/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run\n    raise ClientAppException(str(ex)) from ex\nflwr.client.client_app.ClientAppException: \nException ClientAppException occurred. Message: 429 Client Error: Too Many Requests for url: https://huggingface.co/api/datasets/uoft-cs/cifar10/paths-info/0b2714987fa478483af9968de7c934580d0bb9a2\'>). It originated during client-side execution of a message.')]
[36m(ClientAppActor pid=874387)[0m Client 4 / 10[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client calling[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m client loading model[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data[32m [repeated 8x across cluster][0m
[36m(ClientAppActor pid=874387)[0m loading data completed, start partitioning for 4[32m [repeated 8x across cluster][0m
